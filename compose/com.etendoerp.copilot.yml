services:
  copilot:
    build:
      context: ../copilot
      dockerfile: ../copilot/Dockerfile
    ports:
      - "${COPILOT_PORT:-5005}:${COPILOT_PORT:-5005}"
      - "${COPILOT_PORT_DEBUG:-5100}:${COPILOT_PORT_DEBUG:-5100}"
      - "${COPILOT_PORT_MCP:-5006}:${COPILOT_PORT_MCP:-5006}"
    env_file: ".env"
    volumes:
      - ../copilot:/app/
      - ${SOURCE_PATH}/modules:/modules
      - copilot_attached_files:/copilotAttachedFiles
      - vectordbs:/app/vectordbs
      - checkpoints:/checkpoints
      - /var/run/docker.sock:/var/run/docker.sock
    networks:
      - etendo
    extra_hosts:
      - "host.docker.internal:host-gateway"
volumes:
  copilot_attached_files:
  vectordbs:
  checkpoints:
